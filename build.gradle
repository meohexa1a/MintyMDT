plugins {
    id("java-library")
    id("com.gradleup.shadow") version "8.3.7"
    id("io.micronaut.library") version "4.5.4"
    id("io.micronaut.aot") version "4.5.4"
}

version = "1.0"
group = "com.mdt"

tasks.withType(JavaCompile).configureEach {
    options.encoding = 'UTF-8'
}

ext {
    mindustryVersion = "v154"
    jabelVersion = "93fde537c7"
}

java {
    sourceCompatibility = JavaVersion.toVersion("21")
    targetCompatibility = JavaVersion.toVersion("21")
}

repositories {
    mavenCentral()
    maven { url "https://raw.githubusercontent.com/Zelaux/MindustryRepo/master/repository" }
    maven { url "https://www.jitpack.io" }
}

dependencies {
    compileOnly "com.github.Anuken.Arc:arc-core:$mindustryVersion"
    compileOnly "com.github.Anuken.Mindustry:core:$mindustryVersion"
    annotationProcessor "com.github.Anuken:jabel:$jabelVersion"

    compileOnly "org.projectlombok:lombok"
    annotationProcessor "org.projectlombok:lombok"
    runtimeOnly("ch.qos.logback:logback-classic")

    api("io.micronaut:micronaut-context")
    api("io.micronaut:micronaut-runtime")
    implementation("io.micronaut.cache:micronaut-cache-caffeine")
}

micronaut {
    processing {
        incremental(true)
        annotations("com.mdt.*")
    }
}

shadowJar {
    mergeServiceFiles() 
}